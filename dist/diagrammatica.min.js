!function(a,b){"use strict";function c(){if("number"==typeof window.scrollX&&"number"==typeof window.scrollY)return{x:window.scrollX,y:window.scrollY};if("number"==typeof window.pageXOffset&&"number"==typeof window.pageYOffset)return{x:window.pageXOffset,y:window.pageYOffset};var a=document.documentElement||document.body.parentNode;return("number"!=typeof a.ScrollLeft||"number"!=typeof a.ScrollTop)&&(a=document.body),{x:a.scrollLeft,y:a.scrollTop}}b.diagrammatica=a;var d=function(a,b){function d(){h.xScale=d3.scale.ordinal().domain(b.map(function(a){return a.name})).rangeRoundBands([0,i.paddedHeight()],.1),h.xAxis=d3.svg.axis().scale(h.xScale).orient("left")}function f(){h.yScale=d3.scale.linear().domain([0,d3.max(b,function(a){return a.value})]).range([0,i.paddedWidth()]),h.yAxis=d3.svg.axis().scale(h.yScale).orient("bottom")}function g(a){b=check.defined(a)?a:b,f(),h.renderArea.select(".y.axis").transition().duration(1e3).call(h.yAxis).attr("transform","translate(0,"+i.paddedHeight()+")"),d(),h.renderArea.select(".x.axis").transition().duration(1e3).call(h.xAxis),h.renderArea.selectAll(".bar").data(b).transition().delay(function(a,b){return 100*b}).duration(500).ease("linear").attr("y",function(a){return h.xScale(a.name)}).attr("width",function(a){return h.yScale(a.value)}).attr("height",h.xScale.rangeBand())}a=check.string(a)?d3.select(a):a;var h=new e(a,"bar"),i=h.config;h.height(150),d(),f(),h.renderArea.append("g").attr("class","x axis").call(h.xAxis).append("text").attr("class","label").attr("transform","rotate(-90)").attr("y",-1*i.margin.left).attr("x",i.paddedHeight()/2*-1).attr("dy","1em").style("text-anchor","middle").text(""),h.renderArea.append("g").attr("class","y axis").attr("transform","translate(0,"+i.paddedHeight()+")").call(h.yAxis).append("text").attr("class","label").attr("text-anchor","middle").attr("x",i.paddedWidth()/2).attr("y",28).text("");var k=h.renderArea.selectAll(".bar").data(b).enter().append("rect").attr("class","bar diagrammatica-tooltip-target").attr("x",0).attr("y",function(a){return h.xScale(a.name)}).attr("width",function(a){return h.yScale(a.value)}).attr("height",h.xScale.rangeBand()).attr("fill",function(a){return h.colors(a.value)});return i.tooltipHtml=function(a){var b='<div class="left-arrow diagrammatica-tooltip-inline"></div>';return b+='<div class="diagrammatica-tooltip-content diagrammatica-tooltip-inline">'+a.value+"</div>"},k.on("mouseover",function(a){j.transition().style("opacity",1);var b=this.getBoundingClientRect(),d=j.node().getBoundingClientRect(),e=(b.height-d.height)/2;j.html(i.tooltipHtml(a)).style("left",b.right+"px").style("top",b.top+c().y+e+"px")}).on("mouseout",function(){j.style("opacity",0)}),h.update=g,g.width=function(b){return h.width(b,function(){f(),a.select(".y.axis .label").transition().duration(1e3).attr("x",i.paddedWidth()/2).attr("y",28)})},g.height=function(b){return h.height(b,function(){d(),a.select(".x.axis .label").transition().duration(1e3).attr("y",-1*i.margin.left).attr("x",i.paddedHeight()/2*-1)})},g.yAxisLabelText=function(a){return h.yAxisLabelText(a)},g.xAxisLabelText=function(a){return h.xAxisLabelText(a)},g},e=function(a,b){this.hasRenderedOnce=!1,this.selection=check.string(a)?d3.select(a):a,this.update=function(){};var c={margin:{top:20,right:20,bottom:30,left:40},width:480,height:250};this.config=c,this.config.paddedWidth=function(){return c.width-c.margin.left-c.margin.right},this.config.paddedHeight=function(){return c.height-c.margin.top-c.margin.bottom},this.config.tooltipHtml=function(){return"tooltip content"},this.svg=this.selection.append("svg").attr("class","diagrammatica diagrammatica-"+b).attr("width",c.width).attr("height",c.height),this.renderArea=this.svg.append("g").attr("transform","translate("+c.margin.left+","+c.margin.top+")"),this.updateDimensions=function(){this.svg.attr("width",c.width).attr("height",c.height),this.renderArea.attr("transform","translate("+this.config.margin.left+","+this.config.margin.top+")")},this.xScale=function(){},this.xAxis=function(){},this.yScale=function(){},this.yAxis=function(){},this.colors=d3.scale.category10()};e.prototype={axisLabelText:function(a,b){var c=this.selection.select("."+a+".axis .label");return check.not.defined(b)?c.empty()?"":c.text():(c.text(b),this.update)},yAxisLabelText:function(a){return this.axisLabelText("y",a)},xAxisLabelText:function(a){return this.axisLabelText("x",a)},width:function(a,b){return arguments.length?(this.config.width=a,check.defined(b)&&b(),this.svg.attr("width",this.config.width),this.updateDimensions(),this.update):this.config.width},height:function(a,b){return arguments.length?(this.config.height=a,check.defined(b)&&b(),this.svg.attr("height",this.config.height),this.updateDimensions(),this.update):this.config.height},tooltipHtml:function(a){return arguments.length?(this.config.tooltipHtml=a,this.update):this.config.tooltipHtml()}};var f=function(a,b){function c(){g.xScale=d3.scale.ordinal().domain(b.map(function(a){return a.name})).rangeRoundBands([0,h.paddedHeight()],.1),g.xAxis=d3.svg.axis().scale(g.xScale).orient("bottom")}function d(){g.yScale=d3.scale.linear().domain([0,d3.max(b,function(a){return a.value})]).range([h.paddedHeight(),0]),g.yAxis=d3.svg.axis().scale(g.yScale).orient("left")}function f(a){b=check.defined(a)?a:b,d(),g.renderArea.select(".y.axis").transition().duration(1e3).call(g.yAxis),c(),g.renderArea.select(".x.axis").transition().duration(1e3).call(g.xAxis).attr("transform","translate(0,"+h.paddedHeight()+")"),g.renderArea.selectAll(".column").data(b).transition().duration(1e3).ease("linear").attr("x",function(a){return g.xScale(a.name)}).attr("y",function(a){return g.yScale(a.value)}).attr("width",g.xScale.rangeBand()).attr("height",function(a){return h.paddedHeight()-g.yScale(a.value)})}a=check.string(a)?d3.select(a):a;var g=new e(a,"column"),h=g.config;return c(),d(),g.renderArea.append("g").attr("class","x axis").attr("transform","translate(0,"+h.paddedHeight()+")").call(g.xAxis).append("text").attr("class","x label").attr("text-anchor","middle").attr("x",h.paddedWidth()/2).attr("y",28).text(""),g.renderArea.append("g").attr("class","y axis").call(g.yAxis).append("text").attr("class","y label").attr("transform","rotate(-90)").attr("y",-1*h.margin.left).attr("x",h.paddedHeight()/2*-1).attr("dy","1em").style("text-anchor","middle").text(""),g.renderArea.selectAll(".column").data(b).enter().append("rect").attr("class","column").attr("x",function(a){return g.xScale(a.name)}).attr("y",function(a){return g.yScale(a.value)}).attr("width",g.xScale.rangeBand()).attr("height",function(a){return h.paddedHeight()-g.yScale(a.value)}).attr("fill",function(a){return g.colors(a.value)}),g.update=f,f.width=function(b){return g.width(b,function(){c(),a.select(".x.axis .label").transition().duration(1e3).attr("x",h.paddedWidth()/2).attr("y",28)})},f.height=function(b){return g.height(b,function(){d(),a.select(".y.axis .label").transition().duration(1e3).attr("y",-1*h.margin.left).attr("x",h.paddedHeight()/2*-1)})},f.yAxisLabelText=function(a){return g.yAxisLabelText(a)},f.xAxisLabelText=function(a){return g.xAxisLabelText(a)},f},g=function(a,b){a=check.string(a)?d3.select(a):a;var c=new e(a,"heat-map"),d=c.config;c.config.margin.top=55,c.config.margin.bottom=40,c.config.margin.left=50,c.updateDimensions();var f=d3.set(b.map(function(a){return a.date})).values(),g=Math.floor(d.paddedWidth()/f.length),h=d3.set(b.map(function(a){return a.category})).values(),i=Math.floor(d.paddedHeight()/h.length),j=9,k=colorbrewer.OrRd[j],l=Math.floor(d.paddedWidth()/j),m=d3.scale.linear().domain([0,f.length-1]).range([0,d.paddedWidth()-g]),n=d3.scale.ordinal().domain(b.map(function(a){return a.category})).rangeRoundBands([0,d.paddedHeight()+3]),o=d3.scale.quantile().domain([0,j-1,d3.max(b,function(a){return a.value})]).range(k);c.renderArea.selectAll(".categoryLabel").data(h).enter().append("text").text(function(a){return a}).attr("x",0).attr("y",function(a,b){return b*i}).style("text-anchor","end").attr("transform","translate(-6,"+i/2+")").attr("class",function(a,b){return b>=0&&4>=b?"categoryLabel mono axis axis-category":"categoryLabel mono axis"});var p=d3.time.format("%b %Y");c.renderArea.selectAll(".timeLabel").data(f).enter().append("text").text(function(a){return p(new Date(a))}).attr("x",0).attr("y",function(a,b){return b*g}).style("text-anchor","middle").attr("transform","rotate(-90) translate(30, "+g/2+")").attr("class",function(a,b){return b>=7&&16>=b?"timeLabel mono axis axis-date":"timeLabel mono axis"});var q=c.renderArea.selectAll("rect").data(b).enter().append("rect").attr("x",function(a,b){return m(b%f.length)}).attr("y",function(a){return n(a.category)}).attr("width",g).attr("height",i).style("fill",k[0]);q.transition().duration(1e3).style("fill",function(a){return o(a.value)}),q.append("title").text(function(a){return a.value});var r=c.renderArea.append("g").attr("class","legend"),s=r.selectAll(".legend-item").data([0].concat(o.quantiles()),function(a){return a}).enter().append("g").attr("class","legend-item");s.append("rect").attr("x",function(a,b){return l*b}).attr("y",d.paddedHeight()+10).attr("width",l).attr("height",i/2).style("fill",function(a,b){return k[b]}),s.append("text").text(function(a){return"â‰¥ "+Math.round(a)}).attr("x",function(a,b){return l*b}).attr("y",d.paddedHeight()+i+2);var t=function(){};return t},h=function(a,b){function c(){i.xScale=d3.time.scale().range([0,k.paddedWidth()]),i.xAxis=d3.svg.axis().scale(i.xScale).orient("bottom")}function d(){i.yScale=d3.scale.linear().range([k.paddedHeight(),0]),i.yAxis=d3.svg.axis().scale(i.yScale).orient("left")}function f(a){r.attr("y2",k.paddedHeight()),s.selectAll(".tooltip-rect").remove();var b=k.paddedWidth()/a.length,c=b/2;s.selectAll(".tooltip-rect").data(a[0].data).enter().append("rect").attr("height",k.paddedHeight()).attr("width",b).attr("opacity",0).classed("tooltip-rect",!0).classed("diagrammatica-tooltip-target",!0).attr("x",function(a){return i.xScale(a.x)-c}).on("mouseover",function(b){r.attr("x1",i.xScale(b.x)).attr("x2",i.xScale(b.x)).style("opacity",1),j.transition().style("opacity",1);var c=this.getBoundingClientRect(),d=j.node().getBoundingClientRect(),e=c.left+c.width/2;e+=b===a[0].data[a[0].data.length-1]?-Math.abs(d.width+10):10;var f=a.map(function(a){var c=a.data.filter(function(a){return a.x.getTime()===b.x.getTime()}),d=1===c.length?c[0]:{};return d.name=a.name,d});j.html(k.tooltipHtml(f)).style("left",e+"px").style("top",d3.event.pageY+"px")}).on("mousemove",function(){j.style("top",d3.event.pageY+"px")}).on("mouseout",function(){r.style("opacity",0),j.style("opacity",0)})}function g(a){var b,c=a.map(function(a){return{name:a.name}}),d=t.selectAll("g").data(c).enter().append("g").attr("class","legend-item").on("mouseover",function(a){d.transition().attr("opacity",function(b){return a===b?1:.3}),p.transition().attr("opacity",function(b){return a.name===b.name?1:0})}).on("mouseout",function(){check.object(b)?(d.transition().attr("opacity",function(a){return a===b?1:.3}),p.transition().attr("opacity",function(a){return check.object(b)&&a.name===b.name?1:0})):(d.transition().attr("opacity",1),p.transition().attr("opacity",1))}).on("click",function(a){b=b===a?null:a,check.object(b)?p.attr("opacity",function(a){return check.object(b)&&a.name===b.name?1:0}):p.attr("opacity",1)});d.append("text").text(function(a){return a.name}).each(function(a){a.width=this.getBBox().width}),d.append("rect").attr("class","legend-item-swatch").attr("height",10).attr("width",10).attr("x",-12).attr("y",-10).attr("fill",function(a){return i.colors(a.name)});var e=0;d.attr("transform",function(a,b){return e+=b>0?c[b-1].width+20:0,"translate("+e+",0)"}),i.hasRenderedOnce?t.transition().duration(1e3).attr("transform","translate("+[(k.paddedWidth()-t.node().getBBox().width)/2,k.height-25].join()+")"):t.attr("transform","translate("+[(k.paddedWidth()-t.node().getBBox().width)/2,k.height-25].join()+")")}function h(a){a.forEach(function(a){a.data.forEach(function(a){a.x=l(a.x),a.y=+a.y})}),i.xScale.domain([d3.min(a,function(a){return d3.min(a.data,function(a){return a.x})}),d3.max(a,function(a){return d3.max(a.data,function(a){return a.x})})]),i.yScale.domain([d3.min(a,function(a){return d3.min(a.data,function(a){return a.y})}),d3.max(a,function(a){return d3.max(a.data,function(a){return a.y})})]),o=o.data(a),o.exit().remove(),o.enter().append("g").attr("class","series").append("path").attr("d",function(a){return n(a.data)}).style("stroke",function(a){return i.colors(a.name)}).attr("class","line"),o.select("path").transition().duration(1e3).attr("d",function(a){return n(a.data)}).style("stroke",function(a){return i.colors(a.name)}),i.renderArea.select(".x.axis").transition().duration(1e3).call(i.xAxis).attr("transform","translate(0,"+k.paddedHeight()+")"),i.renderArea.select(".y.axis").transition().duration(1e3).call(i.yAxis),f(a),g(a)}a=check.string(a)?d3.select(a):a;var i=new e(a,"line"),k=i.config;k.margin.bottom=50;var l=d3.time.format("%d-%b-%y").parse,m=d3.time.format("%e %B");c(),d();var n=d3.svg.line().x(function(a){return i.xScale(a.x)}).y(function(a){return i.yScale(a.y)});b.forEach(function(a){a.data.forEach(function(a){a.x=l(a.x),a.y=+a.y})}),i.xScale.domain([d3.min(b,function(a){return d3.min(a.data,function(a){return a.x})}),d3.max(b,function(a){return d3.max(a.data,function(a){return a.x})})]),i.yScale.domain([d3.min(b,function(a){return d3.min(a.data,function(a){return a.y})}),d3.max(b,function(a){return d3.max(a.data,function(a){return a.y})})]),i.renderArea.append("g").attr("class","x axis").attr("transform","translate(0,"+k.paddedHeight()+")").call(i.xAxis).append("text").attr("class","x label").attr("text-anchor","middle").attr("x",k.paddedWidth()/2).attr("y",28).text(""),i.renderArea.append("g").attr("class","y axis").call(i.yAxis).append("text").attr("class","y label").attr("transform","rotate(-90)").attr("y",-1*k.margin.left).attr("x",k.paddedHeight()/2*-1).attr("dy","1em").style("text-anchor","middle").text("");var o=i.renderArea.selectAll("series").data(b).enter().append("g").attr("class","series"),p=o.append("path").attr("class","line").attr("d",function(a){return n(a.data)}).style("stroke",function(a){return i.colors(a.name)}),q=i.renderArea.append("g").attr("class","hover-line"),r=q.append("line").attr("x1",0).attr("x2",0).attr("y1",0).attr("y2",k.paddedHeight());r.style("opacity",0);var s=i.renderArea.append("g").attr("class","tooltip-rect-group");k.tooltipHtml=function(a){var b="";return b+='<div class="diagrammatica-tooltip-content">',a.forEach(function(a){b+='<svg height="10" width="10"><rect height="10" width="10" fill="'+i.colors(a.name)+'"></rect></svg>',b+="<span> "+a.name+"</span> : "+m(a.x)+" : "+a.y+"<br>"}),b+="</div>"},f(b);var t=i.renderArea.append("g").attr("class","legend");return g(b),i.update=h,h.width=function(b){return i.width(b,function(){c(),a.select(".x.axis .label").transition().duration(1e3).attr("x",k.paddedWidth()/2).attr("y",28)})},h.height=function(b){return i.height(b,function(){d(),a.select(".y.axis .label").transition().duration(1e3).attr("y",-1*k.margin.left).attr("x",k.paddedHeight()/2*-1)})},h.yAxisLabelText=function(a){return i.yAxisLabelText(a)},h.xAxisLabelText=function(a){return i.xAxisLabelText(a)},h.tooltipHtml=function(a){return i.tooltipHtml(a)},i.hasRenderedOnce=!0,h},i=function(a,b){function c(){var a=-10;return Math.min(g.width,g.height)/2+a}function d(a){b=check.defined(a)?a:b,b.forEach(function(a){a.population=+a.population}),k.data(i(b)).transition().duration(500).attrTween("d",m),l.data(i(b)).transition().duration(500).attr("transform",function(a){return"translate("+h.centroid(a)+")"}).attr("dy",".35em").style("text-anchor","middle").text(function(a){return a.data.age})}a=check.string(a)?d3.select(a):a;var f=new e(a,"pie"),g=f.config;f.updateDimensions=function(){this.svg.attr("width",g.width).attr("height",g.height),f.renderArea.attr("transform","translate("+g.width/2+","+g.height/2+")")},f.updateDimensions();var h=d3.svg.arc().innerRadius(0),i=d3.layout.pie().sort(null).value(function(a){return a.population}),j=function(){h.outerRadius(c())};j(),b.forEach(function(a){a.population=+a.population});var k=f.renderArea.selectAll("path").data(i(b)).enter().append("path").attr("d",h).style("fill",function(a){return f.colors(a.data.age)}).each(function(a){this.currentAngle=a}),l=f.renderArea.selectAll("text").data(i(b)).enter().append("text").attr("transform",function(a){return"translate("+h.centroid(a)+")"}).attr("dy",".35em").style("text-anchor","middle").text(function(a){return a.data.age}),m=function(a){var b=d3.interpolate(this.currentAngle,a);return this.currentAngle=b(0),function(a){return h(b(a))}};return f.update=d,d.width=function(a){return f.width(a,j)},d.height=function(a){return f.height(a,j)},d},j=d3.select("body").append("div").attr("class","diagrammatica-tooltip").style("opacity",0);document.addEventListener("mousemove",function(a){d3.select(a.toElement).classed("diagrammatica-tooltip-target")||j.style("opacity",0)}),a.bar=d,a.ChartBase=e,a.column=f,a.scrollPosition=c,a.heatMap=g,a.line=h,a.pie=i,a.tooltip=j}({},function(){return this}());
//# sourceMappingURL=diagrammatica.min.js.map